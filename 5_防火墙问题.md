

<img width="946" alt="1709535398987" src="https://github.com/rhcn/network_cap/assets/4653664/b4c905d5-8c84-4f07-a267-48ba349c05e0">


收到两个 SYN 请求，两次重置；两个 SYN 请求，两次重置；SYN 请求，重置。所以看起来新的连接、新的 SYN 正在被重置

让我们看看发出的 SYN 的 IP TTL。TTL 是 128。所以我们发送一个 SYN，我们得到这个重置。繁荣。立刻回来。只花了一毫秒就收到了回复，而且这是未路由的。
嗯，这是什么意思？嗯，这意味着，如果我们查看第二层信息，即以太网 2 信息，即源头，这就是此重置的真正源头 SonicWal。
所以这里我有一个防火墙发起了这次重置。我们发送一个 SYN。SYN 从未到达服务器。它甚至从未越过第一个路由器。

如果你看一下，在数据包 18 和 19 中，如果我们查看其上方和下方的上下文，就会发现良好的数据正在流动。所以这不是网络中断。
相反，新的联系并没有渡过那场大火。因此，这使我们能够专注于防火墙并查看其配置。那么猜猜发现了什么？
我们在防火墙上发现了一个小设置，上面写着：每个用户允许的 TCP 连接数有限制。
因此，如果我的环境中有 20 个用户，则每个用户只能分配 100 个 TCP 连接。这就是该值的设定值。每个用户的 TCP 连接数。
现在，对此的尝试或该设置的原因是为了防止防火墙变得过度拥塞。它不支持具有数千个连接的有状态连接，而只是为您可以作为客户端启动或建立的新连接的数量设置了上限。
所以这个数字非常低，不过一百。我的意思是，TCP 正忙，对吗？如果你打开一个浏览器，如果你只是打开几个不同的服务，那么很快你就会达到一百个。
因此，在这种情况下，我们所做的就是让 SonicWal 参与进来,考虑到你的参数，应该可以设置更高的值。

